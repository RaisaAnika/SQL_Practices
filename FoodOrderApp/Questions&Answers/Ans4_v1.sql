SELECT year, country_name, vendor_name, total_gmv from ( Select  Orders.date_local as year, Orders.country_name, Vendors.vendor_name, Round(sum(Orders.gmv_local),2)  as total_gmv, ROW_NUMBER() OVER (PARTITION BY Orders.country_name, Orders.date_local ORDER BY SUM(Orders.gmv_local) DESC) rn FROM Orders  LEFT JOIN Vendors ON Vendors.id = Orders.vendor_id GROUP By Orders.country_name, Orders.date_local, Vendors.vendor_name )  where rn <= 2 ORDER BY year, country_name, total_gmv DESC;